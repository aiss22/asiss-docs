# 表单插件：表格单元格显示提示信息（Tips）

应用场景：
在单据或动态表单的表格中文本字段的单元格上，设置提示信息（鼠标靠近就显示）
注意：提示信息只能在锁定状态的文本字段上使用

```/// <summary>
/// 【表单插件】表格单元格显示提示信息
/// </summary>
public override void BarItemClick(BarItemClickEventArgs e)
{
    base.BarItemClick(e);
    if(e.BarItemKey == "test2")
    {
        SetTips2();
    }
}
private void SetTips()
{
    var entityKey = "FPOOrderEntry";// 单据体标识
    var fieldKey = "fmaterialname";// 需要提示tips的文本字段标识，不需要大写
    var jsonArray = new JSONArray();
    var objs = this.Model.GetEntityDataObject(this.View.BillBusinessInfo.GetEntity(entityKey));
    for (var i = 0; i < objs.Count; i++)
    {
        var rowIndex =i;//行号索引从0开始
        var materiaObj = objs[i]["MaterialId"] as DynamicObject;
        if (materiaObj == null)
        {
            continue;
        }
        //生成tips文本
        var tipsInfo = new StringBuilder();
        tipsInfo.Append("物料编码：").Append(materiaObj["Number"]).Append(";");
        tipsInfo.Append("物料名称：").Append(materiaObj["Name"]);
        var tipValues = new JSONObject();
        tipValues["E"] = true;
        tipValues["T"] = tipsInfo.ToString();
        //
        var tooltipObj = new JSONObject();
        tooltipObj[rowIndex.ToString()] = tipValues;
        //
        var jsonObj = new JSONObject();
        jsonObj["Key"] = fieldKey;
        jsonObj["row"] = rowIndex;
        jsonObj["Tooltip"] = tooltipObj;
        jsonArray.Add(jsonObj);
    }
    if(jsonArray.Count > 0)
    {

    this.View.GetControl(entityKey).InvokeControlMethod("UpdateFieldStates",jsonArray);
    }
}

private void SetTips2()
{
    var entityKey = "FPOOrderEntry";//单据体标识
    var fieldKey = "FMaterialName";//需要显示tips的文本字段标识，不需要大写
    var entryGrid = this.View.GetControl<EntryGrid>(entityKey);//拿到分录表格控件（EntryGrid就是金蝶的分录表格）
    var objs = this.Model.GetEntityDataObject(this.View.BillBusinessInfo.GetEntity(entityKey));//把当前单据分录里所有行数据，都取出来，放到一个集合（objs）里
    for (var i = 0; i < objs.Count; i++)
    {
        var rowIndex = i;//行号索引从0开始
        var materiaObj = objs[i]["MaterialId"] as DynamicObject;//从当前这行数据里，取到“物料”这个字段的对象
        if (materiaObj == null)
        {
            continue; //为空就跳过本次循环
        }
        //生成tips文本
        var tipsInfo = new StringBuilder();//字符串构建器，用来拼接文字（比+号更快更专业）
        tipsInfo.Append("物料编码：").Append(materiaObj["Number"]).Append(";");
        tipsInfo.Append("物料名称：").Append(materiaObj["Name"]);
        
        var tip = new TooltipEntity();//创建一个提示实体对象
        tip.E = true;//E = Enable,是否启用提示
        tip.T = tipsInfo.ToString();// T = Text,要显示的文字
        entryGrid.SetCellTooltip(fieldKey, tip,rowIndex);

    }
}
```
